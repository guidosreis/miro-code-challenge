{"version":3,"file":"emails-input.min.js","sources":["../src/emails-input.js"],"sourcesContent":[";(function(root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([], factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory();\n  } else {\n    root.EmailsInput = factory();\n  }\n}(typeof global !== 'undefined' ? global : typeof window !== 'undefined' ? window : this, function() {\n  const defaults = {\n    placeholder: 'add...',\n    wrapperClassName: 'emails-block',\n    inputClassName: 'emails-input',\n    emailBlockClassName: 'email-block',\n    emailBlockTextClassName: 'email-block__text',\n    emailBlockRemoveButtonClassName: 'email-block__remove-button'\n  };\n  const plugin = {};\n\n  function init() {\n    const template = getPluginTemplate();\n\n    plugin.element.insertAdjacentHTML('beforeend', template);\n    plugin.emails = [];\n    addEventListeners();\n  }\n\n  function addEventListeners() {\n    on('focusout', delegate(`.${plugin.settings.inputClassName}`, handleInputBlur), plugin.element);\n    on('keypress', delegate(`.${plugin.settings.inputClassName}`, handleInputKeyPress), plugin.element);\n    on('keyup', delegate(`.${plugin.settings.inputClassName}`, handleInputKeyUp), plugin.element);\n    on('click', delegate(`.${plugin.settings.emailBlockRemoveButtonClassName}`, handleRemoveEmail), plugin.element);\n  }\n\n  /**\n   * @param {Object} data\n   */\n  function handleInputBlur({ target }) {\n    const { value } = target;\n\n    if (!value) {\n      return;\n    }\n\n    addEmailBlock(value);\n    target.value = '';\n  }\n\n  /**\n   * @param {Object} event\n   */\n  function handleInputKeyPress(event) {\n    if (event.which === 13) {\n      event.preventDefault();\n    }\n  }\n\n  /**\n   * @param {Object} event\n   */\n  function handleInputKeyUp(event) {\n    const { target, which } = event;\n    const { value } = target;\n    const matches = value.split(',');\n\n    if (value === ',') {\n      target.value = '';\n\n      return;\n    }\n\n    if (which === 13 && value) {\n      addEmailBlock(value);\n      target.value = '';\n\n      return;\n    }\n\n    if (matches.length < 2) {\n      return;\n    }\n\n    matches.forEach(match => {\n      if (match) {\n        addEmailBlock(match.trim());\n      }\n    });\n\n    target.value = '';\n  }\n\n  /**\n   * @param {Object} data\n   */\n  function handleRemoveEmail({ target }) {\n    const emailBlockEl = target.closest(`.${plugin.settings.emailBlockClassName}`);\n    const email = emailBlockEl.querySelector(`.${plugin.settings.emailBlockTextClassName}`).innerText;\n    const index = plugin.emails.indexOf(email);\n\n    removeElement(emailBlockEl);\n\n    if (index >= 0) {\n      plugin.emails.splice(index, 1);\n    }\n  }\n\n  /**\n   * @param {string} email\n   * @returns {boolean}\n   */\n  function addEmailBlock(email) {\n    if (plugin.emails.indexOf(email) >= 0) {\n      return false;\n    }\n\n    const template = getEmailBlockTemplate(email);\n\n    plugin.emails.push(email);\n    document.querySelector(`.${plugin.settings.wrapperClassName}`).insertAdjacentHTML('beforeend', template);\n    return true;\n  }\n\n  function add() {\n    const email = getRandomEmail();\n\n    if (!addEmailBlock(email)) {\n      add();\n    }\n  }\n\n  function getCount() {\n    const count = plugin.emails.reduce((acc, email) => {\n      return validateEmail(email) ? acc + 1 : acc;\n    }, 0);\n\n    window.alert(`Valid emails count: ${count}`);\n  }\n\n  /**\n   * @returns {string}\n   */\n  function getRandomEmail() {\n    const names = [\n      'liam',\n      'noah',\n      'oliver',\n      'william',\n      'lucas',\n      'olivia',\n      'emma',\n      'sophia',\n      'isabella',\n      'charlotte'\n    ];\n\n    const lastNames = [\n      'smith',\n      'johnson',\n      'williams',\n      'brown',\n      'jones'\n    ];\n\n    const name = names[getRandomInt(0, names.length)];\n    const lastName = lastNames[getRandomInt(0, lastNames.length)];\n\n    return `${name}.${lastName}@miro.com`;\n  }\n\n  /**\n   * @param {number} min\n   * @param {number} max\n   * @return {number}\n   */\n  function getRandomInt(min, max) {\n    return Math.floor(Math.random() * (max - min)) + min;\n  }\n\n  /**\n   * @param {string} email\n   * @returns {boolean}\n   */\n  function validateEmail(email) {\n    const re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.test(email);\n  }\n\n  /**\n   * @param {string} type\n   * @param {Function} listener\n   * @param {Element|HTMLDocument|Window} element\n   */\n  function on(type, listener, element = document) {\n    element.addEventListener(type, listener);\n  }\n\n  /**\n   * @param {string} selector\n   * @param {Function} listener\n   * @returns {Function}\n   */\n  function delegate(selector, listener) {\n    return event => {\n      const delegatedTarget = event.target.closest(selector);\n\n      if (!delegatedTarget || !event.target.matches(selector)) {\n        return;\n      }\n\n      listener(event);\n    };\n  }\n\n  /**\n   * @param {Element|HTMLElement} element\n   */\n  function removeElement(element) {\n    const parent = element.parentNode;\n\n    parent.removeChild(element);\n  }\n\n  /**\n   * @returns {string}\n   */\n  function getPluginTemplate() {\n    return `\n      <div class=\"${plugin.settings.wrapperClassName}\"></div>\n      <input class=\"${plugin.settings.inputClassName}\" placeholder=\"${plugin.settings.placeholder}\" />\n    `;\n  }\n\n  /**\n   * @param {string} email\n   * @returns {string}\n   */\n  function getEmailBlockTemplate(email) {\n    const modifierClass = validateEmail(email)\n      ? `${plugin.settings.emailBlockClassName}--valid`\n      : `${plugin.settings.emailBlockClassName}--invalid`;\n\n    return `\n      <div class=\"${plugin.settings.emailBlockClassName} ${modifierClass}\">\n        <span class=\"${plugin.settings.emailBlockTextClassName}\">${email}</span>\n        <button class=\"${plugin.settings.emailBlockRemoveButtonClassName}\">x</button>\n      </div>\n    `;\n  }\n\n  return function(element, options) {\n    if (element.tagName !== 'DIV') {\n      return;\n    }\n\n    plugin.element = element;\n    plugin.settings = Object.assign({}, defaults, options);\n\n    init();\n\n    return {\n      ...plugin,\n      add,\n      getCount\n    };\n  }\n}));\n"],"names":["root","factory","global","window","this","defaults","placeholder","wrapperClassName","inputClassName","emailBlockClassName","emailBlockTextClassName","emailBlockRemoveButtonClassName","plugin","init","template","settings","element","insertAdjacentHTML","emails","on","delegate","handleInputBlur","handleInputKeyPress","handleInputKeyUp","handleRemoveEmail","target","value","addEmailBlock","event","which","preventDefault","matches","split","length","forEach","match","trim","emailBlockEl","closest","email","querySelector","innerText","index","indexOf","parentNode","removeChild","splice","modifierClass","validateEmail","push","document","add","names","lastNames","name","getRandomInt","lastName","getCount","count","reduce","acc","alert","min","max","Math","floor","random","test","type","listener","addEventListener","selector","options","tagName","Object","assign","define","amd","exports","module","EmailsInput"],"mappings":"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"}